<!doctype html>
<html
  lang="{{ with site.Params.isoCode | default (site.LanguageCode | default `en`) }}{{- . -}}{{ end }}"
  dir="{{ cond (site.Params.rtl | default false) `rtl` `ltr` }}"
  class="scroll-smooth"
  data-default-appearance="{{ site.Params.defaultAppearance | default `dark` }}"
  data-auto-appearance="{{ site.Params.autoSwitchAppearance | default `true` }}">

  <!-- Head -->
  {{- partial "head.html" . -}}

  <!-- Lottie Animation Library -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/bodymovin/5.12.2/lottie.min.js"></script>

  <!-- Modern Animation & Styling CSS -->
  <link rel="stylesheet" href="/css/scroll.css">
  
  <!-- Meta tags for modern appearance -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <meta name="theme-color" content="#1e3a8a">

  {{- partialCached "init.html" . -}}

  {{ $bodyLayout := "flex flex-col h-screen m-auto leading-7 max-w-7xl px-6 sm:px-14 md:px-24 lg:px-32" }}
  {{ $bodyColor := "text-lg bg-transparent text-neutral-900 dark:text-neutral-50" }}
  {{ $bodyScrollbar := "scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-sky-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-sky-600" }}

  <body class="{{ $bodyLayout }} {{ $bodyColor }} {{ $bodyScrollbar }}">
    <!-- Background Animation -->
    <div id="lottie-bg" class="fixed inset-0 w-full h-full -z-10"></div>

    <!-- Skip to content link for accessibility -->
    <div id="the-top" class="absolute flex self-center z-50">
      <a
        class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-sky-200 focus:translate-y-0 dark:bg-neutral-700 transition-all duration-300"
        href="#main-content">
        <span class="font-bold text-sky-600 pe-2 dark:text-sky-400">&darr;</span>
        {{ i18n "nav.skip_to_main" }}
      </a>
    </div>

    <!-- Header Navigation -->
    {{ $header := print "header/" site.Params.header.layout ".html" }}
    {{ if templates.Exists ( printf "partials/%s" $header ) }}
      {{ partial $header . }}
    {{ else }}
      {{ partial "header/basic.html" . }}
    {{ end }}

    <!-- Main Content Container -->
    <div class="relative flex flex-col grow">
      <main id="main-content" class="grow animate-fade-in">
        {{ block "main" . }}{{ end }}

        <!-- Scroll to Top Button -->
        {{ if and (site.Params.footer.showScrollToTop | default true) }}
          {{- partial "scroll-to-top.html" . -}}
        {{ end }}
      </main>

      <!-- Footer -->
      {{- partial "footer.html" . -}}

      <!-- Search Component -->
      {{ if site.Params.enableSearch | default false }}
        {{- partial "search.html" . -}}
      {{ end }}
    </div>

    <!-- Smooth scroll behavior for anchor links -->
    <script>
      document.addEventListener('DOMContentLoaded', function() {
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
          anchor.addEventListener('click', function(e) {
            e.preventDefault();
            const target = document.querySelector(this.getAttribute('href'));
            if (target) {
              target.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
          });
        });
      });
    </script>

    <!-- Lottie Background Animation Script -->
    <script>
    document.addEventListener('DOMContentLoaded', function () {
      const container = document.getElementById('lottie-bg');

      lottie.loadAnimation({
        container: container,
        renderer: 'svg',
        loop: true,
        autoplay: true,
        path: '/animations/underwater.json',
        rendererSettings: {
          preserveAspectRatio: 'xMidYMid slice'
        }
      });
    });
    </script>

  </body>

  <!-- Buy Me A Coffee -->
  {{ if site.Params.buymeacoffee.globalWidget | default false }}
    <script
      data-name="BMC-Widget"
      data-cfasync="false"
      src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js"
      data-id="{{ site.Params.buymeacoffee.identifier }}"
      data-description="Support me on Buy me a coffee!"
      {{ with site.Params.buymeacoffee.globalWidgetMessage }}data-message="{{ . }}"{{ end }}
      {{ with site.Params.buymeacoffee.globalWidgetColor | default `#FFDD00` }}data-color="{{ . }}"{{ end }}
      {{ with site.Params.buymeacoffee.globalWidgetPosition }}data-position="{{ . }}"{{ end }}
      data-x_margin="18"
      data-y_margin="18"></script>
  {{ end }}

</html>
